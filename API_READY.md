# ‚úÖ API –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

## üéØ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:

1. ‚úÖ **YandexOAuthService** - —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å OAuth
2. ‚úÖ **YandexAuthController** - endpoints –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
3. ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã** - Client ID –∏ Secret –≤ –∫–æ–¥–µ
4. ‚úÖ **API –∫–ª–∏–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã** - MetrikaClient –∏ DirectClient –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ API
5. ‚úÖ **Jobs –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã** - FetchMetrikaJob –∏ FetchDirectJob –∑–∞–≥—Ä—É–∂–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ OAuth —Ç–æ–∫–µ–Ω

**–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
```
https://oauth.yandex.ru/authorize?response_type=token&client_id=081345a9f48742d18f6cbacf890cfb1b
```

1. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –≤ –Ø–Ω–¥–µ–∫—Å
2. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑ URL (–ø–∞—Ä–∞–º–µ—Ç—Ä `access_token=...`)

### –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ –≤ .env

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` —Ñ–∞–π–ª –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```env
YANDEX_CLIENT_ID=081345a9f48742d18f6cbacf890cfb1b
YANDEX_CLIENT_SECRET=bd90a984306e4d3bb8cdea8fb492610e
YANDEX_OAUTH_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–∑–¥–µ—Å—å
```

### –®–∞–≥ 3: –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à

```bash
php artisan config:clear
```

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ: **`setup.bat`**

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω

```bash
curl http://localhost:8000/api/yandex/validate-token
```

### –®–∞–≥ 5: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

```bash
php artisan analytics:sync-daily
```

–≠—Ç–æ –∑–∞–≥—Ä—É–∑–∏—Ç **—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –∏–∑ API –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞:

–ü–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ:
- http://localhost:5173/statistics
- –î–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è **—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –∏–∑ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∏ –∏ –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç–∞

## üìù –î–æ—Å—Ç—É–ø–Ω—ã–µ endpoints:

- `GET /api/yandex/auth-url` - –ø–æ–ª—É—á–∏—Ç—å URL –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `GET /api/yandex/validate-token` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω
- `GET /api/statistics` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
- `GET /api/visits` - –¥–∞–Ω–Ω—ã–µ –≤–∏–∑–∏—Ç–æ–≤
- `GET /api/sources` - –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞

## ‚ö†Ô∏è –í–∞–∂–Ω–æ:

1. **–¢–æ–∫–µ–Ω –Ω—É–∂–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã API** - –±–µ–∑ –Ω–µ–≥–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è
2. **–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é** - `php artisan analytics:sync-daily`
3. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ë–î –µ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç—ã** –ø–µ—Ä–µ–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π

---

**API –≥–æ—Ç–æ–≤–æ! –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é.** üöÄ

