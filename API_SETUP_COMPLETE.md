# ‚úÖ API –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ!

## üéØ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

1. ‚úÖ **–°–æ–∑–¥–∞–Ω YandexOAuthService** - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å OAuth
2. ‚úÖ **–°–æ–∑–¥–∞–Ω YandexAuthController** - endpoints –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
3. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** - Client ID –∏ Secret —É–∂–µ –≤ –∫–æ–¥–µ
4. ‚úÖ **API endpoints –≥–æ—Ç–æ–≤—ã** - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –°–ï–ô–ß–ê–°:

### 1. –î–æ–±–∞–≤—å—Ç–µ credentials –≤ .env

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` —Ñ–∞–π–ª –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```env
YANDEX_CLIENT_ID=081345a9f48742d18f6cbacf890cfb1b
YANDEX_CLIENT_SECRET=bd90a984306e4d3bb8cdea8fb492610e
YANDEX_OAUTH_TOKEN=–ø–æ–ª—É—á–∏—Ç–µ_—Ç–æ–∫–µ–Ω_–Ω–∏–∂–µ
```

### 2. –ü–æ–ª—É—á–∏—Ç–µ OAuth —Ç–æ–∫–µ–Ω

**–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
   ```
   https://oauth.yandex.ru/authorize?response_type=token&client_id=081345a9f48742d18f6cbacf890cfb1b
   ```

2. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –∏ —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø

3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑ URL (–ø–∞—Ä–∞–º–µ—Ç—Ä `access_token=...`)

4. –í—Å—Ç–∞–≤—å—Ç–µ –≤ `.env`:
   ```env
   YANDEX_OAUTH_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–∑–¥–µ—Å—å
   ```

### 3. –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à

```bash
php artisan config:clear
```

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ: **`setup.bat`**

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω

```bash
curl http://localhost:8000/api/yandex/validate-token
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: `{"success":true,"data":{"is_valid":true,...}}`

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

```bash
php artisan analytics:sync-daily
```

–≠—Ç–æ –∑–∞–≥—Ä—É–∑–∏—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ API –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

–ü–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç:
- http://localhost:5173/statistics
- –î–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è **—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –∏–∑ API, –∞ –Ω–µ —Ç–µ—Å—Ç–æ–≤—ã–µ

## üìù –î–æ—Å—Ç—É–ø–Ω—ã–µ API endpoints:

- `GET /api/yandex/auth-url` - –ø–æ–ª—É—á–∏—Ç—å URL –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `POST /api/yandex/exchange-code` - –æ–±–º–µ–Ω—è—Ç—å –∫–æ–¥ –Ω–∞ —Ç–æ–∫–µ–Ω
- `GET /api/yandex/validate-token` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω
- `GET /api/statistics` - –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
- `GET /api/visits` - –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤–∏–∑–∏—Ç–æ–≤
- `GET /api/sources` - –ø–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞

## ‚ö†Ô∏è –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω:** `curl http://localhost:8000/api/yandex/validate-token`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:** `storage/logs/laravel.log`
3. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç—ã –∏ —Å—á–µ—Ç—á–∏–∫–∏** –≤ –ë–î
4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é:** `php artisan analytics:sync-daily`

---

**API –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é.** üöÄ

